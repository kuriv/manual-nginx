# 负载均衡

准备好两台 Nginx 服务器，使用权重策略来转发请求，权重越高，分配给指定服务器的请求就越多。修改第一台服务器的 `/etc/nginx/nginx.conf` 配置文件如下。

```
http {
	upstream webapp {
		server 192.168.10.233 weight=1;
		server 192.168.10.234 weight=2;
	}
}
```

修改第一台服务器的 `/etc/nginx/sites-enabled/default` 配置文件如下。

```
server {
	listen 80;
	server_name 192.168.10.233;
	root /var/www/html;

	location / {
		proxy_pass http://webapp;
	}
}
```

修改第二台服务器的 `/etc/nginx/sites-enabled/default` 配置文件如下。

```
server {
	listen 80;
	server_name 192.168.10.234;
	root /var/www/html;
}
```

也可以使用 IP 哈希策略来转发请求，所有来自同一个 IP 地址的请求都会被转发到同一台服务器。修改第一台服务器的 `/etc/nginx/nginx.conf` 配置文件如下。

```
http {
	upstream webapp {
		ip_hash;
		server 192.168.10.233;
		server 192.168.10.234;
	}
}
```

修改第一台服务器的 `/etc/nginx/sites-enabled/default` 配置文件如下。

```
server {
	listen 80;
	server_name 192.168.10.233;
	root /var/www/html;

	location / {
		proxy_pass http://webapp;
	}
}
```

修改第二台服务器的 `/etc/nginx/sites-enabled/default` 配置文件如下。

```
server {
	listen 80;
	server_name 192.168.10.234;
	root /var/www/html;
}
```
